# Pickle Exploit Generators & Weaponization Tools

Research into tools that generate malicious pickle files, frameworks for pickle weaponization, and related security tooling. Focused on tools (not theory) for potential use in educational security workshops.

---

## Category 1: Dedicated Pickle Exploit Generators

### 1. Fickling (Trail of Bits)
- **Repo:** https://github.com/trailofbits/fickling
- **PyPI:** https://pypi.org/project/fickling/
- **Type:** Decompiler, static analyzer, and bytecode rewriter for pickle
- **Capabilities:**
  - Decompile pickle bytecode into readable Python
  - Static analysis to detect malicious behaviors
  - **Inject arbitrary code** into existing pickle files (code runs on every load)
  - Symbolically executes pickle VM (safe to run on malicious files)
  - Supports PyTorch model files (.pt, .pth)
  - Used by Hugging Face for pickle scanning on their model hub
- **Ease of Use:** High — pip-installable, CLI and Python API, well-documented
- **Workshop Suitability:** ★★★★★ — Best-in-class. Professional tool from a respected security firm. Can both analyze AND inject payloads. Perfect for demonstrating both offense and defense. Actively maintained.

### 2. Pickleassem
- **Repo:** https://github.com/gousaiyang/pickleassem
- **Type:** Pickle bytecode assembler
- **Capabilities:**
  - Write pickle payloads in an assembly-like Python API
  - Direct control over pickle VM opcodes (MARK, GLOBAL, INST, etc.)
  - Construct arbitrary function calls (e.g., `os.system('cat /etc/passwd')`)
  - Designed for CTF challenges (originated from Balsn CTF 2019)
- **Ease of Use:** Medium — requires understanding pickle VM opcodes, but API is clean
- **Workshop Suitability:** ★★★★☆ — Excellent for teaching pickle internals. Forces understanding of the pickle VM. Good for advanced workshops.

### 3. Pker
- **Repo:** https://github.com/EddieIvan01/pker
- **Type:** Python-to-pickle opcode compiler
- **Capabilities:**
  - Automatically converts Python source code into pickle opcodes
  - No need to understand pickle VM directly — write Python, get pickle payload
  - Supports complex payloads with variable assignments, function calls
- **Ease of Use:** High — write normal Python, tool handles the opcode translation
- **Workshop Suitability:** ★★★★☆ — Great bridge between "I know Python" and "I can exploit pickle". Hides VM complexity but shows the core vulnerability.

### 4. Anapickle (SensePost)
- **Repo:** https://github.com/sensepost/anapickle
- **Type:** Pickle shellcode toolkit (analyzer + generator)
- **Capabilities:**
  - Analyze pickle streams to extract callables without executing them
  - Generate pickle shellcode from a templated library
  - Includes `converttopickle.py` — translates annotated Python-like code to pickle opcodes
  - Contains a shellcode library for common payloads
  - Pickle v0 simulator for safe analysis
- **Ease of Use:** Medium — older tool (2011), Python 2 era, may need adaptation
- **Workshop Suitability:** ★★★☆☆ — Historically significant (Black Hat USA 2011 "Sour Pickles"). Good for teaching history of pickle exploitation. May need modernization for current workshops.
- **Reference:** [Sour Pickles whitepaper (Black Hat 2011)](https://media.blackhat.com/bh-us-11/Slaviero/BH_US_11_Slaviero_Sour_Pickles_WP.pdf)

### 5. evilPick
- **Repo:** https://github.com/francescolacerenza/evilPick
- **Type:** Exploit crafter for pickle deserialization RCE
- **Capabilities:**
  - Takes a Python 2.7 code file as input, outputs a pickle exploit payload
  - Serializes payload with marshal library, base64 encodes, wraps in pickle VM code
  - Supports base64 or hex encoding of crafted exploits
  - Can save exploits to file or let you write Python code dynamically
- **Ease of Use:** High — simple CLI, provide code, get exploit
- **Workshop Suitability:** ★★★☆☆ — Simple and direct. Limited to Python 2.7 which is a drawback. Good for quick demos.

---

## Category 2: Multi-Format Deserialization Payload Generators

### 6. Peas (j0lt)
- **Repo:** https://github.com/j0lt-github/python-deserialization-attack-payload-generator
- **Type:** Multi-module deserialization payload generator
- **Capabilities:**
  - Generates payloads for: **pickle, PyYAML, ruamel.yaml, jsonpickle**
  - Interactive CLI: prompts for RCE command, OS, encoding options
  - Optional base64 encoding
  - Saves payloads to file
- **Ease of Use:** High — interactive wizard-style CLI
- **Workshop Suitability:** ★★★★☆ — Excellent for showing that pickle isn't alone — the deserialization problem spans multiple Python libraries. Good comparative teaching tool.

### 7. deser-py (klezVirus)
- **Repo:** https://github.com/klezVirus/deser-py
- **Type:** Python deserialization payload generator
- **Capabilities:**
  - Generates serialized payloads targeting vulnerable deserializers
  - Works with both `os.system` and `subprocess.Popen` (Popen is more reliable for RCE)
  - Part of a family of tools (deser-node, deser-ruby for other languages)
- **Ease of Use:** High — script-based, straightforward usage
- **Workshop Suitability:** ★★★☆☆ — Good for showing cross-language deserialization patterns. The multi-language family is pedagogically useful.

### 8. pydeserialize (joaoviictorti)
- **Repo:** https://github.com/joaoviictorti/pydeserialize
- **Type:** Payload generator for insecure deserialization
- **Capabilities:**
  - CLI with IP, port, exploit type, and OS parameters
  - Generates reverse shell and base64-encoded payloads
  - Cross-platform (Windows/Linux targeting)
- **Ease of Use:** High — clean CLI with clear options
- **Workshop Suitability:** ★★★☆☆ — Quick and practical for generating test payloads.

---

## Category 3: PoC Exploits & Vulnerable Apps

### 9. Python-Pickle-RCE-Exploit (CalfCrusher)
- **Repo:** https://github.com/CalfCrusher/Python-Pickle-RCE-Exploit
- **Type:** RCE PoC + vulnerable Flask application
- **Capabilities:**
  - Complete exploit + vulnerable target in one repo
  - Demonstrates `__reduce__` method exploitation
  - Includes a vulnerable Flask app for safe testing
  - Clean, educational code structure
- **Ease of Use:** Very High — clone and run
- **Workshop Suitability:** ★★★★★ — Perfect workshop package. Self-contained vulnerable app + exploit. Students can attack a local target safely. Minimal setup.

### 10. pickle-rce-exploit (4nuxd)
- **Repo:** https://github.com/4nuxd/pickle-rce-exploit
- **Type:** PoC RCE exploit for pickle deserialization
- **Capabilities:**
  - Targets applications that deserialize untrusted pickle objects
  - Demonstrates basic RCE through crafted pickle payloads
- **Ease of Use:** High — straightforward PoC
- **Workshop Suitability:** ★★★☆☆ — Simple, good as a starting point.

### 11. Windows-Python-Pickle-Deserialization-Exploit (Spades-Ace)
- **Repo:** https://github.com/Spades-Ace/Windows-Python-Pickle-Deserialization-Exploit
- **Type:** Windows-focused pickle deserialization exploit
- **Capabilities:**
  - Specifically targets Python applications on Windows
  - Includes vulnerable Flask app setup
  - References THM OWASP10 room for learning context
- **Ease of Use:** High — tutorial-style with clear instructions
- **Workshop Suitability:** ★★★☆☆ — Useful if workshop attendees are on Windows.

### 12. Django RCE Exploit (Spix0r)
- **Repo:** https://github.com/Spix0r/django-rce-exploit
- **Type:** Django session cookie deserialization exploit
- **Capabilities:**
  - Exploits Django's `PickleSerializer` for session cookies
  - RCE through forged session cookies
  - Real-world attack vector (Django is a major framework)
- **Ease of Use:** Medium — requires Django context understanding
- **Workshop Suitability:** ★★★★☆ — Shows real-world impact. "This isn't theoretical — major frameworks had this problem."

---

## Category 4: ML/AI-Specific Pickle Exploitation

### 13. Sleepy Pickle (Trail of Bits)
- **Repo:** https://github.com/trailofbits/sleepy-pickle-public
- **Blog:** [Part 1](https://blog.trailofbits.com/2024/06/11/exploiting-ml-models-with-pickle-file-attacks-part-1/), [Part 2](https://blog.trailofbits.com/2024/06/11/exploiting-ml-models-with-pickle-file-attacks-part-2/)
- **Type:** ML model poisoning through pickle injection
- **Capabilities:**
  - Injects malicious code into serialized ML models
  - Payload executes on deserialization and modifies the model in-place
  - Can: insert backdoors, control model outputs, tamper with data, steal user data
  - No trace of malware visible post-attack
  - Variant "Sticky Pickle" adds self-replication into successive model versions
  - Uses Fickling as the underlying injection mechanism
- **Ease of Use:** Medium — requires understanding ML model serialization
- **Workshop Suitability:** ★★★★★ — Cutting-edge, highly relevant to current AI safety. Shows pickle exploitation in its most dangerous modern context: ML supply chain attacks. Backed by excellent Trail of Bits blog posts.

### 14. PickleCloak (Research Framework)
- **Paper:** [The Art of Hide and Seek (arXiv 2508.19774)](https://arxiv.org/abs/2508.19774)
- **Type:** Analysis framework for pickle-based ML supply chain attacks
- **Capabilities:**
  - Maps 22 distinct pickle-based model loading paths across 5 AI/ML frameworks
  - 19 of those paths are entirely missed by existing scanners
  - Exception-Oriented Programming (EOP) technique: 9 instances, 7 bypass all scanners
  - 133 exploitable gadgets with ~100% scanner bypass rate
  - Marshal-based payload obfuscation (compiled bytecode, invisible to scanners)
- **Ease of Use:** Low — research framework, not a turnkey tool
- **Workshop Suitability:** ★★★☆☆ — Academic. Good for advanced audiences. Shows the arms race between scanners and evasion.

---

## Category 5: Payload Collections & Reference Materials

### 15. PayloadsAllTheThings — Python Deserialization
- **Repo:** https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Insecure%20Deserialization/Python.md
- **Web:** https://swisskyrepo.github.io/PayloadsAllTheThings/Insecure%20Deserialization/Python/
- **Type:** Curated payload collection and cheat sheet
- **Capabilities:**
  - Ready-to-use payloads for pickle, PyYAML, jsonpickle
  - Code patterns for `__reduce__` exploits
  - Lists vulnerable sinks: `cPickle.loads`, `pickle.loads`, `_pickle.loads`, `jsonpickle.decode`
  - Links to additional tools and generators
- **Workshop Suitability:** ★★★★★ — Essential reference. Every security workshop should point to this.

### 16. Gists & Templates
- **0xBADCA7 pickle exploit generator:** https://gist.github.com/0xBADCA7/f4c700fcbb5fb8785c14
- **mgeeky RCE payload template:** https://gist.github.com/mgeeky/cbc7017986b2ec3e247aab0b01a9edcd
- **BGrewell reverse shell pickle payload:** https://gist.github.com/BGrewell/ba619281070cc6185d81e32791a2289e (also wrote [Building a Better Rotten Pickle](https://www.bengrewell.com/building-a-better-rotten-pickle/))
- **Reelix Python 2+3 pickle exploit:** https://gist.github.com/Reelix/55adb9d2d64f0d2915657dfb30d61510

---

## Category 6: Defensive / Scanner Tools (with offensive implications)

### 17. Picklescan
- **Repo:** https://github.com/mmaitre314/picklescan
- **Type:** Static security scanner for pickle files
- **Capabilities:**
  - Detects suspicious/unsafe globals in pickle files
  - Used by Hugging Face Hub for model scanning
- **Known Bypasses (important for workshops):**
  - CVE-2025-10155: File extension mismatch bypass (PyTorch extensions)
  - CVE-2025-10156: ZIP file bad CRC bypass
  - CVE-2025-1945: ZIP flag bit manipulation bypass
  - CVE-2025-1716: Unsafe globals bypass (`pip.main()` not blocked)
  - Bypasses fixed in picklescan ≥0.0.31 (Sept 2025)
- **Workshop Suitability:** ★★★★☆ — Essential for showing the defense side. The bypass CVEs are a goldmine for teaching "why static analysis isn't enough."

### 18. ModelScan (Protect AI)
- **Repo:** https://github.com/protectai/modelscan
- **Type:** Multi-format model security scanner
- **Capabilities:**
  - Scans Pickle, PyTorch, TensorFlow, Keras, Sklearn, XGBoost formats
  - Detects unsafe code signatures byte-by-byte
  - Broader coverage than picklescan alone
- **Workshop Suitability:** ★★★★☆ — Good defense counterpart. Show students how to scan, then show how scans can be bypassed.

---

## Category 7: Related / Extended Attack Surface

### 19. jsonpickle Exploitation
- **Vulnerable app:** https://github.com/VerSprite/flask-json-pickle
- **Exploit-DB:** https://www.exploit-db.com/exploits/49585 (jsonpickle 2.0.0 RCE)
- **CVE:** CVE-2020-22083
- **Key point:** jsonpickle's `decode()` uses `eval()` on `py/repr` serialized strings. Vulnerable from first version through current for backward compatibility. No patch — it's by design.
- **Workshop Suitability:** ★★★★☆ — Shows pickle is a family of problems, not just one module.

### 20. blackserial (darkpills)
- **Repo:** https://github.com/darkpills/blackserial
- **Type:** Blackbox gadget chain serializer
- **Capabilities:** Supports Java, PHP, Python, .NET, Ruby, NodeJS deserialization
- **Workshop Suitability:** ★★★☆☆ — Good for showing deserialization as a cross-language problem.

---

## Workshop Recommendations

### Tier 1: Must-Have for Any Pickle Security Workshop
| Tool | Why |
|------|-----|
| **Fickling** | Swiss army knife — analyze, decompile, inject. Professional quality. |
| **Python-Pickle-RCE-Exploit** | Self-contained vulnerable app + exploit. Zero-to-RCE in minutes. |
| **PayloadsAllTheThings** | Reference cheat sheet with ready payloads. |
| **Sleepy Pickle** | Shows modern real-world impact (ML model poisoning). |

### Tier 2: Valuable Additions
| Tool | Why |
|------|-----|
| **Pker** | "Write Python, get pickle exploit" — lowers the barrier to understanding. |
| **Pickleassem** | For deep-dive into pickle VM internals. |
| **Peas** | Shows the problem extends beyond pickle to PyYAML, jsonpickle, etc. |
| **Picklescan + CVE bypasses** | Teaches the scanner arms race. |
| **Django RCE Exploit** | Real-world framework impact. |

### Tier 3: Advanced / Specialized
| Tool | Why |
|------|-----|
| **PickleCloak** | Academic, scanner evasion research. |
| **Anapickle** | Historical significance, pickle shellcoding. |
| **blackserial** | Cross-language deserialization comparison. |

### Suggested Workshop Flow
1. **Intro** — Show `__reduce__` with a simple script (5 min)
2. **Exploit** — Use CalfCrusher's Flask app + exploit to get RCE (10 min)
3. **Analyze** — Use Fickling to decompile and understand the malicious pickle (10 min)
4. **Build** — Use Pker or Pickleassem to craft custom payloads (15 min)
5. **Scale** — Use Peas to show the same attack works across pickle/PyYAML/jsonpickle (10 min)
6. **Real-world** — Demo Sleepy Pickle injecting a backdoor into an ML model (15 min)
7. **Defend** — Scan with Picklescan/ModelScan, then demonstrate bypass techniques (15 min)
8. **Discuss** — Why `pickle.loads()` can never be made safe (design vs. implementation flaw)

---

## Key Observations

1. **Pickle exploitation is trivially easy.** Most tools are under 100 lines of code. The `__reduce__` attack vector requires ~10 lines of Python.

2. **The ecosystem is fragmented.** There's no single "Metasploit for pickle" — instead there are dozens of small PoCs and generators. This actually reflects the simplicity of the attack: you don't need a framework when `os.system` in `__reduce__` works.

3. **ML/AI has massively expanded the attack surface.** Pickle went from "don't deserialize user input" to "every ML model on Hugging Face is a potential attack vector." Sleepy Pickle and PickleCloak represent the current frontier.

4. **Scanner evasion is an active arms race.** Multiple CVEs in 2025 alone show that static analysis of pickle files is fundamentally hard. The pickle VM is Turing-complete, making perfect detection equivalent to the halting problem.

5. **The real fix is avoiding pickle entirely.** SafeTensors (for ML) and JSON/msgpack (for general serialization) are the answer. Tools exist to convert: `safetensors` library, `torch.save(..., _use_new_zipfile_serialization=True)`.
